{% extends 'base.html.twig' %}

{% block title %} {{controller_name}}
{% endblock %}
{% block body %}


	<!-- Breadcrumb Section Begin -->
	<section class="breadcrumb-section set-bg" data-setbg={{ asset('img/breadcrumb.jpg') }}>
		<div class="container">
			<div class="row">
				<div class="col-lg-12 text-center">
					<div class="breadcrumb__text">
						<h2>Panier</h2>
						<div class="breadcrumb__option">
							<a href="{{path('home')}}">Accueil</a>
							<span>panier</span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section><!-- Breadcrumb Section End --><!-- Shoping Cart Section Begin --><section class="shoping-cart spad">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="shoping__cart__table">


						<table>
							<thead>
								<tr>
									<th class="shoping__product">Produit</th>
									<th>Prix</th>
									<th>Quantité</th>
									<th>Totale</th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								{% for item in panier %}
									<tr class="produit{{item.produit.id}}">
										<td class="shoping__cart__item">
											<img style="width:17%" src="{{ asset(item.produit.image) }}" alt="">
											<h5>
												{{item.produit.libelle}}
											</h5>
										</td>
										{% if item.promotion.reduction != 0 and date(item.promotion.dateDebut) < date() and date(item.promotion.dateFin) > date() %}
											<td class="shoping__cart__price">
												{{ (item.produit.prixUnitaire - item.promotion.reduction * item.produit.prixUnitaire/100) | number_format(2, '.', ',')}}
											</td>
										{% else %}
											<td class="shoping__cart__price">
												{{ item.produit.prixUnitaire | number_format(2, '.', ',')}}
											</td>
										{% endif %}
										<td class="shoping__cart__quantity">
											<div class="quantity">
												<div class="pro-qty">
													<a class="dec-qtybtn" id="dec-qtybtn{{item.produit.id}}" href="{{path("decrease_qte", {"id": item.produit.id } )}}">
														<span class="dec qtybtn ">-</span>
													</a>
													{% if item.qte == 1 %}
														<script>
															document.getElementById('dec-qtybtn' + {{ item.produit.id }}).style.display = 'none';
														</script>
													{% endif %}
													<input class="qteProduit{{item.produit.id}}" id="qteProduit{{item.produit.id}}" type="text" value={{ item.qte }}>
													<a class="inc-qtybtn" href="{{ path("increase_qte", {"id": item.produit.id } )}}">
														<span class="inc qtybtn ">+</span>
													</a>

												</div>
											</div>
										</td>
										{% if item.promotion.reduction != 0 and date(item.promotion.dateDebut) < date() and date(item.promotion.dateFin) > date() %}
											<td class="shoping__cart__total " id="shoping__cart__total{{item.produit.id}}">
												{{ ((item.produit.prixUnitaire - item.promotion.reduction* item.produit.prixUnitaire/100)*item.qte) | number_format(2, '.', ',') }}MAD
											</td>
										{% else %}
											<td class="shoping__cart__total " id="shoping__cart__total{{item.produit.id}}">
												{{ (item.produit.prixUnitaire*item.qte) | number_format(2, '.', ',') }}MAD
											</td>
										{% endif %}
										<td class="shoping__cart__item__close">
											<a class="remove-prod" href="{{path('cart_remove', {'id': item.produit.id})}}">
												<span class="icon_close"></span>
											</a>
										</td>
									</tr>
								{% endfor %}
							</tbody>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-lg-12">
				<div class="shoping__cart__btns">
					<a href={{ path('shoping_grid') }} class="primary-btn cart-btn">CONTINUE SHOPPING</a>
					<a href={{ path('update_panier') }} class="primary-btn cart-btn cart-btn-right">
						<span class="icon_loading"></span>
						Upadate Cart</a>
				</div>
			</div>
			<div class="col-lg-6">
				<div class="shoping__continue">
					<div class="shoping__discount">
						<h5>Discount Codes</h5>
						<form action="#">
							<input type="text" placeholder="Enter your coupon code">
							<button type="submit" class="site-btn">APPLY COUPON</button>
						</form>
					</div>
				</div>
			</div>
			<div class="col-lg-6">
				<div class="shoping__checkout">
					<h5>Totale À Payer</h5>
					<ul>
						<li>Totale Hors Taxes
							<span class="total">{{ total | number_format(2, '.', ',') }}
								MAD</span>
						</li>
						<li>TVA (20%)
							<span class="tva">{{ tva | number_format(2, '.', ',') }}
								MAD</span>
						</li>
						<li>Totale(TTC)
							<span class="totalTtc">{{ totalTtc | number_format(2, '.', ',') }}
								MAD
							</span>
						</li>
					</ul>
					<a href={{ path('checkout') }} class="primary-btn">PROCEED TO CHECKOUT</a>
				</div>
			</div>
		</div>
	</div>
</section><!-- Shoping Cart Section End -->{% endblock %}

{% block javascripts %}
<script src="{{asset('js/shoping-cart-ajax.js')}}"></script>
	<script src="{{asset('js/subscribers-ajax.js')}}"></script>
{% endblock %}
